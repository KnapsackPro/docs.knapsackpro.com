"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[977],{3905:(e,n,a)=>{a.d(n,{Zo:()=>_,kt:()=>k});var t=a(7294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function l(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function i(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?l(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function o(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},l=Object.keys(e);for(t=0;t<l.length;t++)a=l[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(t=0;t<l.length;t++)a=l[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=t.createContext({}),p=function(e){var n=t.useContext(s),a=n;return e&&(a="function"==typeof e?e(n):i(i({},n),e)),a},_=function(e){var n=p(e.components);return t.createElement(s.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},u=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,_=o(e,["components","mdxType","originalType","parentName"]),u=p(a),k=r,m=u["".concat(s,".").concat(k)]||u[k]||c[k]||l;return a?t.createElement(m,i(i({ref:n},_),{},{components:a})):t.createElement(m,i({ref:n},_))}));function k(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=u;var o={};for(var s in n)hasOwnProperty.call(n,s)&&(o[s]=n[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var p=2;p<l;p++)i[p]=a[p];return t.createElement.apply(null,i)}return t.createElement.apply(null,a)}u.displayName="MDXCreateElement"},5162:(e,n,a)=>{a.d(n,{Z:()=>i});var t=a(7294),r=a(6010);const l="tabItem_Ymn6";function i(e){let{children:n,hidden:a,className:i}=e;return t.createElement("div",{role:"tabpanel",className:(0,r.Z)(l,i),hidden:a},n)}},4866:(e,n,a)=>{a.d(n,{Z:()=>S});var t=a(7462),r=a(7294),l=a(6010),i=a(2466),o=a(6550),s=a(1980),p=a(7392),_=a(12);function c(e){return function(e){return r.Children.map(e,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:n,label:a,attributes:t,default:r}}=e;return{value:n,label:a,attributes:t,default:r}}))}function u(e){const{values:n,children:a}=e;return(0,r.useMemo)((()=>{const e=n??c(a);return function(e){const n=(0,p.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,a])}function k(e){let{value:n,tabValues:a}=e;return a.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:a}=e;const t=(0,o.k6)(),l=function(e){let{queryString:n=!1,groupId:a}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:n,groupId:a});return[(0,s._X)(l),(0,r.useCallback)((e=>{if(!l)return;const n=new URLSearchParams(t.location.search);n.set(l,e),t.replace({...t.location,search:n.toString()})}),[l,t])]}function d(e){const{defaultValue:n,queryString:a=!1,groupId:t}=e,l=u(e),[i,o]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!k({value:n,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const t=a.find((e=>e.default))??a[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:l}))),[s,p]=m({queryString:a,groupId:t}),[c,d]=function(e){let{groupId:n}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(n),[t,l]=(0,_.Nk)(a);return[t,(0,r.useCallback)((e=>{a&&l.set(e)}),[a,l])]}({groupId:t}),N=(()=>{const e=s??c;return k({value:e,tabValues:l})?e:null})();(0,r.useLayoutEffect)((()=>{N&&o(N)}),[N]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!k({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);o(e),p(e),d(e)}),[p,d,l]),tabValues:l}}var N=a(2389);const h="tabList__CuJ",T="tabItem_LNqP";function E(e){let{className:n,block:a,selectedValue:o,selectValue:s,tabValues:p}=e;const _=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.o5)(),u=e=>{const n=e.currentTarget,a=_.indexOf(n),t=p[a].value;t!==o&&(c(n),s(t))},k=e=>{let n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const a=_.indexOf(e.currentTarget)+1;n=_[a]??_[0];break}case"ArrowLeft":{const a=_.indexOf(e.currentTarget)-1;n=_[a]??_[_.length-1];break}}n?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":a},n)},p.map((e=>{let{value:n,label:a,attributes:i}=e;return r.createElement("li",(0,t.Z)({role:"tab",tabIndex:o===n?0:-1,"aria-selected":o===n,key:n,ref:e=>_.push(e),onKeyDown:k,onClick:u},i,{className:(0,l.Z)("tabs__item",T,i?.className,{"tabs__item--active":o===n})}),a??n)})))}function C(e){let{lazy:n,children:a,selectedValue:t}=e;if(a=Array.isArray(a)?a:[a],n){const e=a.find((e=>e.props.value===t));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},a.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t}))))}function P(e){const n=d(e);return r.createElement("div",{className:(0,l.Z)("tabs-container",h)},r.createElement(E,(0,t.Z)({},e,n)),r.createElement(C,(0,t.Z)({},e,n)))}function S(e){const n=(0,N.Z)();return r.createElement(P,(0,t.Z)({key:String(n)},e))}},8073:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>C,contentTitle:()=>T,default:()=>b,frontMatter:()=>h,metadata:()=>E,toc:()=>P});var t=a(7462),r=a(7294),l=a(3905),i=a(412);const o="url-search-params-changed",s=e=>{const n=i.Z.canUseDOM?location.search:"",a=new URLSearchParams(n);return new Set(a.getAll(e))},p=e=>{const[n,a]=(0,r.useState)(s(e));(0,r.useEffect)((()=>{const n=()=>{a(s(e))};window.addEventListener(o,n)}),[e]);return[n,a=>{const t=a(n);history.pushState(null,"",`?${((e,n)=>{const a=new URLSearchParams(location.search);return a.delete(e),n.forEach((n=>a.append(e,n))),a.toString()})(e,t)}`),dispatchEvent(new CustomEvent(o))}]},_=e=>{let{inUrl:n,items:a}=e;const[t,l]=p(n),i=e=>{l((n=>{const a=new Set(n),t=e.target.value;return e.target.checked?a.add(t):a.delete(t),a}))};return r.createElement("ul",{className:"none-list"},a.map((e=>r.createElement("li",{key:e.value},r.createElement("label",null,r.createElement("input",{type:"checkbox",name:n,value:e.value,checked:t.has(e.value),onChange:i})," ",e.label)))))},c=e=>{let{inUrl:n,items:a}=e;const[t,l]=p(n);(0,r.useEffect)((()=>{if(t.size>0)return;const e=a.find((e=>e.defaultChecked));e&&l((()=>new Set([e.value])))}),[]);const i=e=>{l((()=>{const n=new Set,a=e.target.value;return e.target.checked?n.add(a):n.delete(a),n}))};return r.createElement("ul",{className:"none-list"},a.map((e=>r.createElement("li",{key:e.value},r.createElement("label",null,r.createElement("input",{type:"radio",name:n,value:e.value,checked:t.has(e.value),onChange:i})," ",e.label)))))},u=e=>{let{searchParam:n,children:a}=e;const[t]=p(n);return 0===t.size?null:r.createElement(r.Fragment,null,a)},k=e=>{let{searchParam:n,value:a,children:t}=e;const[l]=p(n);return l.has(a)?r.createElement(r.Fragment,null,t):null},m=e=>{let{milliseconds:n}=e;return(0,r.useEffect)((()=>{const e=location.hash;setTimeout((()=>{location.hash="",location.hash=e}),n)}),[]),null};var d=a(4866),N=a(5162);const h={toc_max_heading_level:2,pagination_next:null,pagination_prev:null},T="Installation guide for the knapsack_pro ruby gem",E={unversionedId:"knapsack_pro-ruby/guide/index",id:"knapsack_pro-ruby/guide/index",title:"Installation guide for the knapsack_pro ruby gem",description:"Create an account to generate API tokens and use the knapsack_pro gem.",source:"@site/docs/knapsack_pro-ruby/guide/index.md",sourceDirName:"knapsack_pro-ruby/guide",slug:"/knapsack_pro-ruby/guide/",permalink:"/knapsack_pro-ruby/guide/",draft:!1,editUrl:"https://github.com/KnapsackPro/docs.knapsackpro.com/tree/main/docusaurus/docs/knapsack_pro-ruby/guide/index.md",tags:[],version:"current",frontMatter:{toc_max_heading_level:2,pagination_next:null,pagination_prev:null},sidebar:"sidebar"},C={},P=[{value:"Installation",id:"installation",level:2},{value:"Questions",id:"questions",level:2},{value:"Instructions",id:"instructions",level:2},{value:"Ruby on Rails",id:"ruby-on-rails",level:3},{value:"Ruby Project",id:"ruby-project",level:3},{value:"RSpec",id:"rspec",level:3},{value:"Minitest",id:"minitest",level:3},{value:"test-unit",id:"test-unit",level:3},{value:"Cucumber",id:"cucumber",level:3},{value:"Spinach",id:"spinach",level:3},{value:"VCR/WebMock/FakeWeb",id:"vcrwebmockfakeweb",level:3},{value:"AppVeyor",id:"appveyor",level:3},{value:"Buildkite",id:"buildkite",level:3},{value:"CircleCI",id:"circleci",level:3},{value:"Cirrus CI",id:"cirrus-ci",level:3},{value:"CloudBees CodeShip",id:"cloudbees-codeship",level:3},{value:"Codefresh",id:"codefresh",level:3},{value:"GitHub Actions",id:"github-actions",level:3},{value:"GitLab CI",id:"gitlab-ci",level:3},{value:"GitLab CI &gt;= 11.5",id:"gitlab-ci--115",level:4},{value:"GitLab CI &lt; 11.5",id:"gitlab-ci--115-1",level:4},{value:"Heroku CI",id:"heroku-ci",level:3},{value:"Jenkins",id:"jenkins",level:3},{value:"Semaphore CI",id:"semaphore-ci",level:3},{value:"Semaphore 2.0",id:"semaphore-20",level:4},{value:"Travis CI",id:"travis-ci",level:3},{value:"Other CI provider",id:"other-ci-provider",level:3},{value:"Verify that everything works",id:"verify-that-everything-works",level:3},{value:"Next up",id:"next-up",level:3},{value:"Need help?",id:"need-help",level:2}],S={toc:P};function b(e){let{components:n,...a}=e;return(0,l.kt)("wrapper",(0,t.Z)({},S,a,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"installation-guide-for-the-knapsack_pro-ruby-gem"},"Installation guide for the ",(0,l.kt)("inlineCode",{parentName:"h1"},"knapsack_pro")," ruby gem"),(0,l.kt)(m,{milliseconds:400,mdxType:"DelayHashNavigation"}),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"http://knapsackpro.com?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide"},"Create an account")," to generate API tokens and use the ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," gem."),(0,l.kt)("h2",{id:"installation"},"Installation"),(0,l.kt)("p",null,"Add ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," to your ",(0,l.kt)("inlineCode",{parentName:"p"},"Gemfile"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"group :test, :development do\n  gem 'knapsack_pro'\nend\n")),(0,l.kt)("p",null,"Execute:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"bundle install\n")),(0,l.kt)("p",null,"Now, fill in the following form to generate the instruction steps for your project."),(0,l.kt)("h2",{id:"questions"},"Questions"),(0,l.kt)("p",null,"Please answer the following questions to generate the configuration for your project:"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Do you use Ruby on Rails?")),(0,l.kt)(c,{inUrl:"rails",items:[{value:"yes",label:"Yes",defaultChecked:!0},{value:"no",label:"No"}],mdxType:"RadioGroup"}),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Choose your testing tools:")),(0,l.kt)(_,{inUrl:"test-runner",items:[{value:"rspec",label:"RSpec"},{value:"cucumber",label:"Cucumber"},{value:"minitest",label:"Minitest"},{value:"spinach",label:"Spinach"},{value:"test-unit",label:"test-unit"}],mdxType:"CheckboxGroup"}),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Do you use the VCR, WebMock, or FakeWeb gem?")),(0,l.kt)(c,{inUrl:"vcr",items:[{value:"yes",label:"Yes"},{value:"no",label:"No"}],mdxType:"RadioGroup"}),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"What is your CI provider?")),(0,l.kt)(c,{inUrl:"ci",items:[{value:"appveyor",label:"AppVeyor"},{value:"buildkite",label:"Buildkite"},{value:"circleci",label:"CircleCI"},{value:"cirrus-ci",label:"Cirrus CI"},{value:"codeship",label:"CloudBees CodeShip"},{value:"codefresh",label:"Codefresh"},{value:"github-actions",label:"GitHub Actions"},{value:"gitlab-ci",label:"GitLab CI"},{value:"heroku-ci",label:"Heroku CI"},{value:"jenkins",label:"Jenkins"},{value:"semaphoreci",label:"Semaphore CI"},{value:"travis-ci",label:"Travis CI"},{value:"other",label:"Other"}],mdxType:"RadioGroup"}),(0,l.kt)("h2",{id:"instructions"},"Instructions"),(0,l.kt)(k,{searchParam:"rails",value:"yes",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"ruby-on-rails"},"Ruby on Rails"),(0,l.kt)("p",null,"Please follow the steps down below. Should you get stuck, here you can find a ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/KnapsackPro/rails-app-with-knapsack_pro"},"Rails application")," with ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," already configured.")),(0,l.kt)(k,{searchParam:"rails",value:"no",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"ruby-project"},"Ruby Project"),(0,l.kt)("p",null,"Since you are not using Rails, add the following the bottom of your ",(0,l.kt)("inlineCode",{parentName:"p"},"Rakefile"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"KnapsackPro.load_tasks if defined?(KnapsackPro)\n"))),(0,l.kt)(k,{searchParam:"test-runner",value:"rspec",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"rspec"},"RSpec"),(0,l.kt)("p",null,"Add the following code at the beginning of your ",(0,l.kt)("inlineCode",{parentName:"p"},"spec/rails_helper.rb")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"spec/spec_helper.rb"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"require 'knapsack_pro'\n\n# Custom Knapsack Pro config here\n\nKnapsackPro::Adapters::RSpecAdapter.bind\n"))),(0,l.kt)(k,{searchParam:"test-runner",value:"minitest",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"minitest"},"Minitest"),(0,l.kt)("p",null,"Add the following code after you load the app environment in ",(0,l.kt)("inlineCode",{parentName:"p"},"test/test_helper.rb"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"ENV['RAILS_ENV'] ||= 'test'\nrequire File.expand_path('../../config/environment', __FILE__)\nrequire 'rails/test_help'\n\nrequire 'knapsack_pro'\n\n# Custom Knapsack Pro config here\n\nknapsack_pro_adapter = KnapsackPro::Adapters::MinitestAdapter.bind\nknapsack_pro_adapter.set_test_helper_path(__FILE__)\n"))),(0,l.kt)(k,{searchParam:"test-runner",value:"test-unit",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"test-unit"},"test-unit"),(0,l.kt)("p",null,"Add the following code at the beginning of your ",(0,l.kt)("inlineCode",{parentName:"p"},"test/test_helper.rb"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"require 'knapsack_pro'\n\n# Custom Knapsack Pro config here\n\nknapsack_pro_adapter = KnapsackPro::Adapters::TestUnitAdapter.bind\nknapsack_pro_adapter.set_test_helper_path(__FILE__)\n"))),(0,l.kt)(k,{searchParam:"test-runner",value:"cucumber",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"cucumber"},"Cucumber"),(0,l.kt)("p",null,"Create ",(0,l.kt)("inlineCode",{parentName:"p"},"features/support/knapsack_pro.rb")," with the following code:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"require 'knapsack_pro'\n\n# Custom Knapsack Pro config here\n\nKnapsackPro::Adapters::CucumberAdapter.bind\n"))),(0,l.kt)(k,{searchParam:"test-runner",value:"spinach",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"spinach"},"Spinach"),(0,l.kt)("p",null,"Create ",(0,l.kt)("inlineCode",{parentName:"p"},"features/support/knapsack_pro.rb")," with the following code:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"require 'knapsack_pro'\n\n# Custom Knapsack Pro config here\n\nKnapsackPro::Adapters::SpinachAdapter.bind\n"))),(0,l.kt)(k,{searchParam:"vcr",value:"yes",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"vcrwebmockfakeweb"},"VCR/WebMock/FakeWeb"),(0,l.kt)("p",null,"Add the Knapsack Pro API's subdomain to ",(0,l.kt)("a",{parentName:"p",href:"https://relishapp.com/vcr/vcr/v/6-1-0/docs/configuration/ignore-request"},"ignored hosts")," in ",(0,l.kt)("inlineCode",{parentName:"p"},"spec/spec_helper.rb")," (or wherever your VCR configuration is located):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"require 'vcr'\n\nVCR.configure do |config|\n  config.hook_into :webmock # or :fakeweb\n  config.ignore_hosts('localhost', '127.0.0.1', '0.0.0.0', 'api.knapsackpro.com')\nend\n\n# Add the following code if you use Webmock\nrequire 'webmock/rspec'\nWebMock.disable_net_connect!(allow_localhost: true, allow: ['api.knapsackpro.com'])\n\n# Add the following code if you use FakeWeb\nrequire 'fakeweb'\nFakeWeb.allow_net_connect = %r[^https?://api\\.knapsackpro\\.com]\n")),(0,l.kt)("p",null,"You may need to add ",(0,l.kt)("inlineCode",{parentName:"p"},"require: false")," in your Gemfile:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"group :test do\n  gem 'vcr'\n  gem 'webmock', require: false # when using Webmock\n  gem 'fakeweb', require: false # when using Fakeweb\nend\n")),(0,l.kt)("p",null,"If some tests are failing due to requests to the Knapsack Pro API, you may have some code that reconfigures WebMock/FakeWeb. The usual suspects are calls to ",(0,l.kt)("inlineCode",{parentName:"p"},"WebMock.reset!")," or an ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/bblimke/webmock/issues/484#issuecomment-116193449"},"issue")," with ",(0,l.kt)("inlineCode",{parentName:"p"},"webmock/rspec"),". In the latter case, you can solve the problem with:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"RSpec.configure do |config|\n  config.after(:suite) do\n    WebMock.disable_net_connect!(\n      allow_localhost: true,\n      allow: [\n        'api.knapsackpro.com',\n      ],\n    )\n  end\nend\n"))),(0,l.kt)(k,{searchParam:"ci",value:"appveyor",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"appveyor"},"AppVeyor"),(0,l.kt)("p",null,"Generate ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide_appveyor"},"API tokens")," for each ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," command."),(0,l.kt)("p",null,"For each parallel job, define:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_test_suite_token_"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_total"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_TOTAL"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_index"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_INDEX")))),(0,l.kt)("p",null,"Remember to configure the number of parallel CI nodes in AppVeyor."),(0,l.kt)(d.Z,{mdxType:"Tabs"},(0,l.kt)(N.Z,{value:"node-1",label:"Node 1",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=0 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=0 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n"))),(0,l.kt)(N.Z,{value:"node-2",label:"Node 2",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=1 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=1 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n"))),(0,l.kt)(N.Z,{value:"node-n",label:"Node N",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=N-1 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=N-1 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n"))))),(0,l.kt)(k,{searchParam:"ci",value:"buildkite",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"buildkite"},"Buildkite"),(0,l.kt)("p",null,"Generate ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide_buildkite"},"API tokens")," for each ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," command."),(0,l.kt)("p",null,"Remember to configure the ",(0,l.kt)("inlineCode",{parentName:"p"},"parallelism")," parameter in your build step."),(0,l.kt)(d.Z,{mdxType:"Tabs"},(0,l.kt)(N.Z,{value:"node-1",label:"Node 1",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n"))),(0,l.kt)(N.Z,{value:"node-2",label:"Node 2",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n"))),(0,l.kt)(N.Z,{value:"node-n",label:"Node N",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n")))),(0,l.kt)("p",null,"When using the ",(0,l.kt)("inlineCode",{parentName:"p"},"docker-compose")," plugin on Buildkite, you have to pass the following environment variables:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},'steps:\n  - label: "Test"\n    parallelism: 2\n    plugins:\n      - docker-compose#3.0.3:\n        run: app\n        # highlight-next-line\n        command: bundle exec rake knapsack_pro:rspec\n        config: docker-compose.test.yml\n        # highlight-start\n        env:\n          - BUILDKITE_PARALLEL_JOB_COUNT\n          - BUILDKITE_PARALLEL_JOB\n          - BUILDKITE_BUILD_NUMBER\n          - BUILDKITE_COMMIT\n          - BUILDKITE_BRANCH\n          - BUILDKITE_BUILD_CHECKOUT_PATH\n        # highlight-end\n')),(0,l.kt)("p",null,"Here you can find an article on ",(0,l.kt)("a",{parentName:"p",href:"http://docs.knapsackpro.com/2017/auto-balancing-7-hours-tests-between-100-parallel-jobs-on-ci-buildkite-example"},"how to set up a new pipeline for your project in Buildkite and configure Knapsack Pro"),"."),(0,l.kt)("p",null,"You can also check out the following example repositories for Ruby on Rails projects:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/KnapsackPro/buildkite-rails-parallel-example-with-knapsack_pro"},"Buildkite Rails Parallel Example with Knapsack Pro")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/KnapsackPro/buildkite-rails-docker-parallel-example-with-knapsack_pro"},"Buildkite Rails Docker Parallel Example with Knapsack Pro")))),(0,l.kt)(k,{searchParam:"ci",value:"circleci",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"circleci"},"CircleCI"),(0,l.kt)("p",null,"Generate ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide_circleci"},"API tokens")," for each ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," command."),(0,l.kt)("p",null,"Remember to add additional parallel containers in the CircleCI settings."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title=".circleci/config.yml"',title:'".circleci/config.yml"'},"version: 2\njobs:\n  build:\n    # highlight-next-line\n    parallelism: 2\n\n    steps:\n      - checkout\n\n      # ...\n\n      # highlight-start\n      - run:\n        name: RSpec with knapsack_pro\n        command: |\n          KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\n            bundle exec rake knapsack_pro:rspec\n      # highlight-end\n\n      # highlight-start\n      - run:\n        name: Cucumber with knapsack_pro\n        command: |\n          KNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\n            bundle exec rake knapsack_pro:cucumber\n\n        # ...Same for minitest, spinach, test_unit\n      # highlight-end\n\n")),(0,l.kt)("p",null,"Here you can find an example of a ",(0,l.kt)("a",{parentName:"p",href:"https://docs.knapsackpro.com//2017/circleci-2-0-capybara-feature-specs-selenium-webdriver-with-chrome-headless"},"Rails project config on CircleCI 2.0"),".")),(0,l.kt)(k,{searchParam:"ci",value:"cirrus-ci",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"cirrus-ci"},"Cirrus CI"),(0,l.kt)("p",null,"Generate ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide_cirrusci"},"API tokens")," for each ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," command."),(0,l.kt)("p",null,"Remember to configure the number of parallel CI nodes in Cirrus."),(0,l.kt)(d.Z,{mdxType:"Tabs"},(0,l.kt)(N.Z,{value:"node-1",label:"Node 1",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n"))),(0,l.kt)(N.Z,{value:"node-2",label:"Node 2",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n"))),(0,l.kt)(N.Z,{value:"node-n",label:"Node N",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n")))),(0,l.kt)("p",null,"Here is an example of a ",(0,l.kt)("a",{parentName:"p",href:"https://cirrus-ci.org/examples/#ruby"},(0,l.kt)("inlineCode",{parentName:"a"},".cirrus.yml")," configuration file"),".")),(0,l.kt)(k,{searchParam:"ci",value:"codeship",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"cloudbees-codeship"},"CloudBees CodeShip"),(0,l.kt)("p",null,"Generate ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide_codeship"},"API tokens")," for each ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," command."),(0,l.kt)("p",null,"For each parallel job, define:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_test_suite_token_"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_total"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_TOTAL"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_index"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_INDEX")))),(0,l.kt)(d.Z,{mdxType:"Tabs"},(0,l.kt)(N.Z,{value:"node-1",label:"Node 1",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=0 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=0 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n"))),(0,l.kt)(N.Z,{value:"node-2",label:"Node 2",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=1 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=1 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n"))),(0,l.kt)(N.Z,{value:"node-n",label:"Node N",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=N-1 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=N-1 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n")))),(0,l.kt)("p",null,"Consider moving the ",(0,l.kt)("inlineCode",{parentName:"p"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*")," to the ",(0,l.kt)("em",{parentName:"p"},"Environment")," page of your project settings in CodeShip.")),(0,l.kt)(k,{searchParam:"ci",value:"codefresh",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"codefresh"},"Codefresh"),(0,l.kt)("p",null,"Generate ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide_codefresh"},"API tokens")," for each ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," command."),(0,l.kt)("p",null,"Define in ",(0,l.kt)("inlineCode",{parentName:"p"},".codefresh/codefresh.yml"),":"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_test_suite_token_"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_total"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_TOTAL"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_index"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_INDEX")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"In the ",(0,l.kt)("inlineCode",{parentName:"li"},"matrix")," section, list all the ",(0,l.kt)("inlineCode",{parentName:"li"},"KNAPSACK_PRO_CI_NODE_INDEX"),"es (from ",(0,l.kt)("inlineCode",{parentName:"li"},"0")," to ",(0,l.kt)("inlineCode",{parentName:"li"},"KNAPSACK_PRO_CI_NODE_TOTAL-1"),").")))),(0,l.kt)("p",null,"Remember to configure the YAML file path on Codefresh: ",(0,l.kt)("em",{parentName:"p"},"Pipelines > Settings (cog icon next to the pipeline) > Workflow Tab (horizontal menu on the top) > Path to YAML > ",(0,l.kt)("inlineCode",{parentName:"em"},"./.codefresh/codefresh.yml")),"."),(0,l.kt)("p",null,"Here's an example config for Ruby on Rails and PostgreSQL in a Docker container:"),(0,l.kt)(d.Z,{mdxType:"Tabs"},(0,l.kt)(N.Z,{value:"codefresh.yml",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title=".codefresh/codefresh.yml"',title:'".codefresh/codefresh.yml"'},'version: "1.0"\n\nstages:\n  - "clone"\n  - "build"\n  - "tests"\n\nsteps:\n  main_clone:\n    type: "git-clone"\n    description: "Cloning main repository..."\n    repo: "${{CF_REPO_OWNER}}/${{CF_REPO_NAME}}"\n    revision: "${{CF_BRANCH}}"\n    stage: "clone"\n  BuildTestDockerImage:\n    title: Building Test Docker image\n    type: build\n    arguments:\n      image_name: \'${{CF_ACCOUNT}}/${{CF_REPO_NAME}}-test\'\n      tag: \'${{CF_BRANCH_TAG_NORMALIZED}}-${{CF_SHORT_REVISION}}\'\n      dockerfile: Test.Dockerfile\n    stage: "build"\n\n  run_tests:\n    stage: "tests"\n    image: \'${{BuildTestDockerImage}}\'\n    working_directory: /src\n    fail_fast: false\n    environment:\n      - RAILS_ENV=test\n      # highlight-next-line\n      - KNAPSACK_PRO_CI_NODE_TOTAL=2\n      - PGHOST=postgres\n      - PGUSER=rails-app-with-knapsack_pro\n      - PGPASSWORD=password\n    services:\n      composition:\n        postgres:\n          image: postgres:latest\n          environment:\n            - POSTGRES_DB=rails-app-with-knapsack_pro_test\n            - POSTGRES_PASSWORD=password\n            - POSTGRES_USER=rails-app-with-knapsack_pro\n          ports:\n            - 5432\n    # highlight-start\n    matrix:\n      environment:\n        - KNAPSACK_PRO_CI_NODE_INDEX=0\n        - KNAPSACK_PRO_CI_NODE_INDEX=1\n    # highlight-end\n    commands:\n      - bin/rails db:prepare\n      # highlight-start\n      - KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN bundle exec rake knapsack_pro:rspec\n      - KNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN bundle exec rake knapsack_pro:cucumber\n      - KNAPSACK_PRO_TEST_SUITE_TOKEN_MINITEST=MY_MINITEST_API_TOKEN bundle exec rake knapsack_pro:minitest\n      - KNAPSACK_PRO_TEST_SUITE_TOKEN_TEST_UNIT=MY_TEST_UNIT_API_TOKEN bundle exec rake knapsack_pro:test_unit\n      - KNAPSACK_PRO_TEST_SUITE_TOKEN_SPINACH=MY_SPINACH_API_TOKEN bundle exec rake knapsack_pro:spinach\n      # highlight-end\n')),(0,l.kt)("p",null,"Consider setting up the ",(0,l.kt)("inlineCode",{parentName:"p"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*")," on the Codefresh dashboard: ",(0,l.kt)("em",{parentName:"p"},"Pipelines > Settings (cog icon next to the pipeline) > Variables Tab (vertical menu on the right-hand side)"),".")),(0,l.kt)(N.Z,{value:"dockerfile",label:"Dockerfile",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Test.Dockerfile"',title:'"Test.Dockerfile"'},"FROM ruby:2.6.5-alpine3.10\n\n# Prepare Docker image for Nokogiri\nRUN apk add --update \\\n  build-base \\\n  libxml2-dev \\\n  libxslt-dev \\\n  jq \\\n  nodejs \\\n  npm \\\n  postgresql-dev \\\n  python3-dev \\\n  sqlite-dev \\\n  git \\\n  && rm -rf /var/cache/apk/*\n\n# Install AWS CLI\nRUN pip3 install awscli\n\n# Use libxml2, libxslt packages from alpine for building nokogiri\nRUN bundle config build.nokogiri --use-system-libraries\n\n# Install Codefresh CLI\nRUN wget https://github.com/codefresh-io/cli/releases/download/v0.31.1/codefresh-v0.31.1-alpine-x64.tar.gz\nRUN tar -xf codefresh-v0.31.1-alpine-x64.tar.gz -C /usr/local/bin/\n\nCOPY . /src\n\nWORKDIR /src\n\nRUN bundle install\n"))))),(0,l.kt)(k,{searchParam:"ci",value:"github-actions",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"github-actions"},"GitHub Actions"),(0,l.kt)("p",null,"Generate ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide_githubactions"},"API tokens")," for each ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," command."),(0,l.kt)("p",null,"Define in ",(0,l.kt)("inlineCode",{parentName:"p"},".github/workflows/main.yaml"),":"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_test_suite_token_"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_total"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_TOTAL"))," using the ",(0,l.kt)("a",{parentName:"li",href:"https://help.github.com/en/articles/workflow-syntax-for-github-actions#jobsjob_idstrategymatrix"},(0,l.kt)("inlineCode",{parentName:"a"},"matrix")," property")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_index"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_INDEX"))," using the ",(0,l.kt)("a",{parentName:"li",href:"https://help.github.com/en/articles/workflow-syntax-for-github-actions#jobsjob_idstrategymatrix"},(0,l.kt)("inlineCode",{parentName:"a"},"matrix")," property"),":")),(0,l.kt)("p",null,"Here's an example config for a Ruby on Rails project:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},'# .github/workflows/main.yaml\nname: Main\n\non: [push]\n\njobs:\ntest:\n  runs-on: ubuntu-latest\n\n  # If you need a DB, then define it in the service below.\n  # https://github.com/actions/example-services/tree/master/.github/workflows\n  services:\n    postgres:\n      image: postgres:10.8\n      env:\n        POSTGRES_USER: postgres\n        POSTGRES_PASSWORD: ""\n        POSTGRES_DB: postgres\n      ports:\n        - 5432:5432\n      # needed because the postgres container does not provide a healthcheck\n      # tmpfs makes DB faster by using RAM\n      options: >-\n        --mount type=tmpfs,destination=/var/lib/postgresql/data\n        --health-cmd pg_isready\n        --health-interval 10s\n        --health-timeout 5s\n        --health-retries 5\n    redis:\n      image: redis\n      ports:\n        - 6379:6379\n      options: --entrypoint redis-server\n\n  strategy:\n    fail-fast: false\n    # highlight-start\n    matrix:\n      ci_node_total: [2]\n      ci_node_index: [0, 1]\n    # highlight-end\n\n  env:\n    RAILS_ENV: test\n    GEMFILE_RUBY_VERSION: 2.7.2\n    PGHOST: localhost\n    PGUSER: postgres\n    # Rails verifies the time zone in DB is the same as the time zone of the Rails app\n    TZ: "Europe/Warsaw"\n\n  steps:\n    - uses: actions/checkout@v2\n\n    - name: Set up Ruby\n      uses: ruby/setup-ruby@v1\n      with:\n        # Not needed with a .ruby-version file\n        ruby-version: 2.7\n        # runs \'bundle install\' and caches installed gems automatically\n        bundler-cache: true\n\n    - name: Create DB\n      run: |\n        bin/rails db:prepare\n\n    # highlight-start\n    - name: Run tests\n      env:\n        KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC: MY_RSPEC_API_TOKEN\n        KNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER: MY_CUCUMBER_API_TOKEN\n        KNAPSACK_PRO_TEST_SUITE_TOKEN_MINITEST: MY_MINITEST_API_TOKEN\n        KNAPSACK_PRO_TEST_SUITE_TEST_UNIT: MY_MINITEST_API_TOKEN\n        KNAPSACK_PRO_TEST_SUITE_TOKEN_SPINACH: MY_SPINACH_API_TOKEN\n        KNAPSACK_PRO_CI_NODE_TOTAL: ${{ matrix.ci_node_total }}\n        KNAPSACK_PRO_CI_NODE_INDEX: ${{ matrix.ci_node_index }}\n        KNAPSACK_PRO_LOG_LEVEL: info\n      run: |\n        bundle exec rake knapsack_pro:rspec\n        bundle exec rake knapsack_pro:cucumber\n        bundle exec rake knapsack_pro:minitest\n        bundle exec rake knapsack_pro:test_unit\n        bundle exec rake knapsack_pro:spinach\n    # highlight-end\n')),(0,l.kt)("p",null,"Remember to set up the ",(0,l.kt)("inlineCode",{parentName:"p"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*")," in ",(0,l.kt)("em",{parentName:"p"},"GitHub Settings > Secrets")," as suggested by ",(0,l.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/security-guides/encrypted-secrets#creating-encrypted-secrets-for-a-repository"},"GitHub Actions' docs"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC: ${{ secrets.KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC }}\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER: ${{ secrets.KNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER }}\nKNAPSACK_PRO_TEST_SUITE_TOKEN_MINITEST: ${{ secrets.KNAPSACK_PRO_TEST_SUITE_TOKEN_MINITEST }}\nKNAPSACK_PRO_TEST_SUITE_TEST_UNIT: ${{ secrets.KNAPSACK_PRO_TEST_SUITE_TOKEN_TEST_UNIT }}\nKNAPSACK_PRO_TEST_SUITE_TOKEN_SPINACH: ${{ secrets.KNAPSACK_PRO_TEST_SUITE_TOKEN_SPINACH }}\n"))),(0,l.kt)(k,{searchParam:"ci",value:"gitlab-ci",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"gitlab-ci"},"GitLab CI"),(0,l.kt)("p",null,"Generate ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide_gitlabci"},"API tokens")," for each ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," command."),(0,l.kt)("h4",{id:"gitlab-ci--115"},"GitLab CI >= 11.5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"test:\n  parallel: 2\n\n  script:\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN bundle exec rake knapsack_pro:rspec\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN bundle exec rake knapsack_pro:cucumber\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_MINITEST=MY_MINITEST_API_TOKEN bundle exec rake knapsack_pro:minitest\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_TEST_UNIT=MY_TEST_UNIT_API_TOKEN bundle exec rake knapsack_pro:test_unit\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_SPINACH=MY_SPINACH_API_TOKEN bundle exec rake knapsack_pro:spinach\n")),(0,l.kt)("p",null,"See also ",(0,l.kt)("a",{parentName:"p",href:"https://docs.gitlab.com/ee/ci/yaml/#parallel"},"how to configure running parallel CI nodes in GitLab"),"."),(0,l.kt)("h4",{id:"gitlab-ci--115-1"},"GitLab CI < 11.5"),(0,l.kt)("p",null,"Define in ",(0,l.kt)("inlineCode",{parentName:"p"},".gitlab-ci.yml"),":"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_test_suite_token_"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_total"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_TOTAL"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_index"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_INDEX")))),(0,l.kt)("p",null,"Here's an example configuration for 2 parallel jobs:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title=".gitlab-ci.yml"',title:'".gitlab-ci.yml"'},"stages:\n  - test\n\n# highlight-start\nvariables:\n  KNAPSACK_PRO_CI_NODE_TOTAL: 2\n# highlight-end\n\ntest_ci_first_node:\n  stage: test\n  script:\n    # highlight-start\n    - export KNAPSACK_PRO_CI_NODE_INDEX=0\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN bundle exec rake knapsack_pro:rspec\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN bundle exec rake knapsack_pro:cucumber\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_MINITEST=MY_MINITEST_API_TOKEN bundle exec rake knapsack_pro:minitest\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_TEST_UNIT=MY_TEST_UNIT_API_TOKEN bundle exec rake knapsack_pro:test_unit\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_SPINACH=MY_SPINACH_API_TOKEN bundle exec rake knapsack_pro:spinach\n    # highlight-end\n\ntest_ci_second_node:\n  stage: test\n  script:\n    # highlight-start\n    - export KNAPSACK_PRO_CI_NODE_INDEX=1\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN bundle exec rake knapsack_pro:rspec\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN bundle exec rake knapsack_pro:cucumber\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_MINITEST=MY_MINITEST_API_TOKEN bundle exec rake knapsack_pro:minitest\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_TEST_UNIT=MY_TEST_UNIT_API_TOKEN bundle exec rake knapsack_pro:test_unit\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_SPINACH=MY_SPINACH_API_TOKEN bundle exec rake knapsack_pro:spinach\n    # highlight-end\n")),(0,l.kt)("p",null,"Remember to set up the ",(0,l.kt)("inlineCode",{parentName:"p"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*")," as ",(0,l.kt)("a",{parentName:"p",href:"https://gitlab.com/help/ci/variables/README.md#secret-variables"},"Secret Variables")," in GitLab CI: ",(0,l.kt)("em",{parentName:"p"},"Settings > CI/CD Pipelines > Secret Variables"),".")),(0,l.kt)(k,{searchParam:"ci",value:"heroku-ci",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"heroku-ci"},"Heroku CI"),(0,l.kt)("p",null,"Generate ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide_herokuci"},"API tokens")," for each ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," command."),(0,l.kt)("p",null,"Define in ",(0,l.kt)("inlineCode",{parentName:"p"},"app.json"),":"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_test_suite_token_"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"quantity"),": number of parallel dynos"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"test"),": the Knapsack Pro command (or ",(0,l.kt)("a",{parentName:"li",href:"/ruby/heroku/#run-multiple-test-suites"},"multiple commands"),")")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="app.json"',title:'"app.json"'},'{\n"environments": {\n  "test": {\n    "formation": {\n      "test": {\n        // highlight-next-line\n        "quantity": 2\n      }\n    },\n    "addons": [\n      "heroku-postgresql"\n    ],\n    // highlight-start\n    "scripts": {\n      "test": "bundle exec rake knapsack_pro:rspec"\n    },\n    "env": {\n      "KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC": "MY_RSPEC_API_TOKEN"\n    }\n    // highlight-end\n  }\n}\n}\n')),(0,l.kt)("p",null,"Remember to set up the ",(0,l.kt)("inlineCode",{parentName:"p"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*")," outside of ",(0,l.kt)("inlineCode",{parentName:"p"},"app.json")," in your Heroku CI pipeline's settings.")),(0,l.kt)(k,{searchParam:"ci",value:"jenkins",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"jenkins"},"Jenkins"),(0,l.kt)("p",null,"Generate ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide_jenkins"},"API tokens")," for each ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," command."),(0,l.kt)("p",null,"In order to run parallel jobs with Jenkins you should use Jenkins Pipeline as described in ",(0,l.kt)("a",{parentName:"p",href:"https://www.cloudbees.com/blog/parallelism-and-distributed-builds-jenkins"},"Parallelism and Distributed Builds with Jenkins"),"."),(0,l.kt)("p",null,"Here is an example of a ",(0,l.kt)("inlineCode",{parentName:"p"},"Jenkinsfile")," working with Jenkins Pipeline:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-groovy"},'timeout(time: 60, unit: \'MINUTES\') {\nnode() {\n  stage(\'Checkout\') {\n    checkout([/* checkout code from git */])\n\n    // determine git commit hash because we need to pass it to knapsack_pro\n    COMMIT_HASH = sh(returnStdout: true, script: \'git rev-parse HEAD\').trim()\n\n    stash \'source\'\n  }\n}\n\n// highlight-next-line\ndef num_nodes = 4; // define your total number of CI nodes (how many parallel jobs will be executed)\ndef nodes = [:]\n\nfor (int i = 0; i < num_nodes; i++) {\n  def index = i;\n  nodes["ci_node_${i}"] = {\n    node() {\n      stage(\'Setup\') {\n        unstash \'source\'\n        // other setup steps\n      }\n\n      // highlight-start\n      def knapsack_options = """\\\n          KNAPSACK_PRO_CI_NODE_TOTAL=${num_nodes}\\\n          KNAPSACK_PRO_CI_NODE_INDEX=${index}\\\n          KNAPSACK_PRO_COMMIT_HASH=${COMMIT_HASH}\\\n          KNAPSACK_PRO_BRANCH=${env.BRANCH_NAME}\\\n          KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN\n          KNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN\n      """\n\n      stage(\'Run rspec\') {\n        sh """KNAPSACK_PRO_CI_NODE_BUILD_ID=${env.BUILD_TAG} ${knapsack_options} bundle exec rake knapsack_pro:rspec"""\n      }\n\n      stage(\'Run cucumber\') {\n        sh """${knapsack_options} bundle exec rake knapsack_pro:cucumber"""\n      }\n      // highlight-end\n\n      // ...Same for minitest, spinach, test_unit\n    }\n  }\n}\n\nparallel nodes // run CI nodes in parallel\n}\n')),(0,l.kt)("p",null,"Consider setting up the ",(0,l.kt)("inlineCode",{parentName:"p"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*")," as global environment variables in Jenkins.")),(0,l.kt)(k,{searchParam:"ci",value:"semaphoreci",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"semaphore-ci"},"Semaphore CI"),(0,l.kt)("p",null,"Generate ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide_semaphoreci"},"API tokens")," for each ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," command."),(0,l.kt)("h4",{id:"semaphore-20"},"Semaphore 2.0"),(0,l.kt)("p",null,"Define in ",(0,l.kt)("inlineCode",{parentName:"p"},".semaphore/semaphore.yml"),":"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_test_suite_token_"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"parallelism"))),(0,l.kt)("p",null,"Here's an example config for a Rails project:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title=".semaphore/semaphore.yml"',title:'".semaphore/semaphore.yml"'},"version: v1.0\n\nname: Demo Rails 5 app\n\nagent:\nmachine:\n  type: e1-standard-2\n  os_image: ubuntu1804\n\nblocks:\n- name: Setup\n  task:\n    jobs:\n      - name: bundle\n        commands:\n          - checkout\n          - cache restore gems-$SEMAPHORE_GIT_BRANCH-$(checksum Gemfile.lock),gems-$SEMAPHORE_GIT_BRANCH-,gems-master-\n          - sem-version ruby 2.6.1\n          - bundle install --jobs=4 --retry=3 --path vendor/bundle\n          - cache store gems-$SEMAPHORE_GIT_BRANCH-$(checksum Gemfile.lock) vendor/bundle\n\n- name: RSpec tests\n  task:\n    env_vars:\n      - name: RAILS_ENV\n        value: test\n      - name: PGHOST\n        value: 127.0.0.1\n      - name: PGUSER\n        value: postgres\n      # highlight-start\n      - name: KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC\n        value: MY_RSPEC_API_TOKEN\n      - name: KNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER\n        value: MY_CUCUMBER_API_TOKEN\n      # highlight-end\n    prologue:\n      commands:\n        - checkout\n        - cache restore gems-$SEMAPHORE_GIT_BRANCH-$(checksum Gemfile.lock),gems-$SEMAPHORE_GIT_BRANCH-,gems-master-\n        - sem-service start postgres\n        - sem-version ruby 2.6.1\n        - bundle install --jobs=4 --retry=3 --path vendor/bundle\n        - bundle exec rake db:setup\n\n    # highlight-start\n    jobs:\n      - name: Run tests with Knapsack Pro\n        parallelism: 2\n        commands:\n        - bundle exec rake knapsack_pro:rspec\n        - bundle exec rake knapsack_pro:cucumber\n\n      # ...Same for minitest, spinach, test_unit\n    # highlight-end\n")),(0,l.kt)("p",null,"Remember to set up ",(0,l.kt)("inlineCode",{parentName:"p"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*")," as a ",(0,l.kt)("a",{parentName:"p",href:"https://docs.semaphoreci.com/article/66-environment-variables-and-secrets"},"secret"),".")),(0,l.kt)(k,{searchParam:"ci",value:"travis-ci",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"travis-ci"},"Travis CI"),(0,l.kt)("p",null,"Generate ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide_travisci"},"API tokens")," for each ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," command."),(0,l.kt)("p",null,"Define in ",(0,l.kt)("inlineCode",{parentName:"p"},".travis.yml"),":"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_test_suite_token_"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_total"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_TOTAL"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_index"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_INDEX"))," as ",(0,l.kt)("a",{parentName:"li",href:"http://docs.travis-ci.com/user/speeding-up-the-build/#parallelizing-your-builds-across-virtual-machines"},"jobs"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},'script:\n  - "bundle exec rake knapsack_pro:rspec"\n  - "bundle exec rake knapsack_pro:cucumber"\n  - "bundle exec rake knapsack_pro:minitest"\n  - "bundle exec rake knapsack_pro:test_unit"\n  - "bundle exec rake knapsack_pro:spinach"\n\nenv:\n  global:\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_MINITEST=MY_MINITEST_API_TOKEN\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_TEST_UNIT=MY_TEST_UNIT_API_TOKEN\n    - KNAPSACK_PRO_TEST_SUITE_TOKEN_SPINACH=MY_SPINACH_API_TOKEN\n    - KNAPSACK_PRO_CI_NODE_TOTAL=3\n  jobs:\n    - KNAPSACK_PRO_CI_NODE_INDEX=0\n    - KNAPSACK_PRO_CI_NODE_INDEX=1\n    - KNAPSACK_PRO_CI_NODE_INDEX=2\n')),(0,l.kt)("p",null,"Remember to set up ",(0,l.kt)("inlineCode",{parentName:"p"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*")," as tokens in the Travis settings to avoid exposing them in the build logs."),(0,l.kt)("p",null,"You can find more info about the global and matrix env configuration in the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.travis-ci.com/user/customizing-the-build/#build-matrix"},"Travis' docs"),".")),(0,l.kt)(k,{searchParam:"ci",value:"other",mdxType:"ShowIfSearchParamAndValue"},(0,l.kt)("h3",{id:"other-ci-provider"},"Other CI provider"),(0,l.kt)("p",null,"Generate ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard?utm_source=docs_knapsackpro&utm_medium=page&utm_campaign=knapsack_pro-ruby_gem&utm_content=installation_guide_otherci"},"API tokens")," for each ",(0,l.kt)("inlineCode",{parentName:"p"},"knapsack_pro")," command."),(0,l.kt)("p",null,"Define the following global environment variables on your CI server:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_test_suite_token_"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_TEST_SUITE_TOKEN_*"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_repository_adapter"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_REPOSITORY_ADAPTER=git"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_project_dir"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_PROJECT_DIR"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_total"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_TOTAL"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/ruby/reference/#knapsack_pro_ci_node_index"},(0,l.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_CI_NODE_INDEX"))," as ",(0,l.kt)("a",{parentName:"li",href:"http://docs.travis-ci.com/user/speeding-up-the-build/#parallelizing-your-builds-across-virtual-machines"},"jobs"))),(0,l.kt)(d.Z,{mdxType:"Tabs"},(0,l.kt)(N.Z,{value:"node-1",label:"Node 1",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=0 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=0 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n"))),(0,l.kt)(N.Z,{value:"node-2",label:"Node 2",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=1 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=1 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n"))),(0,l.kt)(N.Z,{value:"node-n",label:"Node N",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"KNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=N-1 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC=MY_RSPEC_API_TOKEN \\\nbundle exec rake knapsack_pro:rspec\n\nKNAPSACK_PRO_CI_NODE_TOTAL=N \\\nKNAPSACK_PRO_CI_NODE_INDEX=N-1 \\\nKNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=MY_CUCUMBER_API_TOKEN \\\nbundle exec rake knapsack_pro:cucumber\n\n# ...Same for minitest, spinach, test_unit\n"))))),(0,l.kt)(u,{searchParam:"ci",mdxType:"ShowIfSearchParam"},(0,l.kt)("h3",{id:"verify-that-everything-works"},"Verify that everything works"),(0,l.kt)("p",null,"Push a new commit to your repository and visit your ",(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/dashboard"},"dashboard")," to make sure all your CI nodes were recorded successfully in ",(0,l.kt)("em",{parentName:"p"},"Show build metrics > Show (build)"),"."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Congratulations!")," Now that Knapsack Pro knows the statistics of your test suite, your CI builds will be parallelized optimally."),(0,l.kt)("h3",{id:"next-up"},"Next up"),(0,l.kt)("p",null,"For an even faster CI build, switch to ",(0,l.kt)("a",{parentName:"p",href:"/ruby/queue-mode/"},"Queue Mode")," and ",(0,l.kt)("a",{parentName:"p",href:"/ruby/split-by-test-examples/"},"Split by test examples"),"."),(0,l.kt)("p",null,"Make sure you check out the ",(0,l.kt)("em",{parentName:"p"},"Advanced")," and ",(0,l.kt)("em",{parentName:"p"},"Use Knapsack Pro with...")," pages from the navigation to fine-tune your Knapsack Pro setup.")),(0,l.kt)("h2",{id:"need-help"},"Need help?"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://knapsackpro.com/contact"},"Get in touch!")),(0,l.kt)("p",null,"We have helped TONS of teams and seen TONS of projects. We know each test suite is a different beast and we'd be happy to help you setting up Knapsack Pro."))}b.isMDXComponent=!0}}]);