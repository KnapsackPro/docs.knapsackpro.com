"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[338],{3905:(e,r,t)=>{t.d(r,{Zo:()=>c,kt:()=>f});var n=t(7294);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function s(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var u=n.createContext({}),l=function(e){var r=n.useContext(u),t=r;return e&&(t="function"==typeof e?e(r):i(i({},r),e)),t},c=function(e){var r=l(e.components);return n.createElement(u.Provider,{value:r},e.children)},p={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},d=n.forwardRef((function(e,r){var t=e.components,a=e.mdxType,o=e.originalType,u=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=l(t),f=a,m=d["".concat(u,".").concat(f)]||d[f]||p[f]||o;return t?n.createElement(m,i(i({ref:r},c),{},{components:t})):n.createElement(m,i({ref:r},c))}));function f(e,r){var t=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=d;var s={};for(var u in r)hasOwnProperty.call(r,u)&&(s[u]=r[u]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=t[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,t)}d.displayName="MDXCreateElement"},1201:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>u,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var n=t(7462),a=(t(7294),t(3905));const o={pagination_next:null,pagination_prev:null},i="Use Knapsack Pro with Cucumber",s={unversionedId:"ruby/cucumber",id:"ruby/cucumber",title:"Use Knapsack Pro with Cucumber",description:"Load tests faster with spring",source:"@site/docs/ruby/cucumber.md",sourceDirName:"ruby",slug:"/ruby/cucumber",permalink:"/ruby/cucumber",draft:!1,editUrl:"https://github.com/KnapsackPro/docs.knapsackpro.com/tree/main/docusaurus/docs/ruby/cucumber.md",tags:[],version:"current",frontMatter:{pagination_next:null,pagination_prev:null},sidebar:"sidebar"},u={},l=[{value:"Load tests faster with spring",id:"load-tests-faster-with-spring",level:2},{value:"Require different config files",id:"require-different-config-files",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"How do I fix <code>invalid option: --require</code>?",id:"how-do-i-fix-invalid-option---require",level:3},{value:"How do I fix <code>cannot load such file -- stripe_mock (LoadError)</code>?",id:"how-do-i-fix-cannot-load-such-file----stripe_mock-loaderror",level:3},{value:"Related FAQs",id:"related-faqs",level:2}],c={toc:l};function p(e){let{components:r,...t}=e;return(0,a.kt)("wrapper",(0,n.Z)({},c,t,{components:r,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"use-knapsack-pro-with-cucumber"},"Use Knapsack Pro with Cucumber"),(0,a.kt)("h2",{id:"load-tests-faster-with-spring"},"Load tests faster with spring"),(0,a.kt)("p",null,"Take a look at ",(0,a.kt)("a",{parentName:"p",href:"/ruby/spring/"},"Use Knapsack Pro with ",(0,a.kt)("inlineCode",{parentName:"a"},"spring")),"."),(0,a.kt)("h2",{id:"require-different-config-files"},"Require different config files"),(0,a.kt)("p",null,"You may want to require different Cucumber configurations for different sets of tests (e.g., user dashboard tests vs admin dashboard tests). You can do so with ",(0,a.kt)("a",{parentName:"p",href:"/ruby/reference/#knapsack_pro_test_dir-cucumber"},(0,a.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_TEST_DIR"))," and ",(0,a.kt)("a",{parentName:"p",href:"/ruby/reference/#knapsack_pro_test_file_pattern"},(0,a.kt)("inlineCode",{parentName:"a"},"KNAPSACK_PRO_TEST_FILE_PATTERN")),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'# User\nexport KNAPSACK_PRO_TEST_DIR="features/support/cucumber_config_1.rb"\nexport KNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=api_token_1\nexport KNAPSACK_PRO_TEST_FILE_PATTERN="features/user_dashboard/**{,/*/**}/*.feature"\nbundle exec rake "knapsack_pro:queue:cucumber[--verbose]"\n\n# Admin\nexport KNAPSACK_PRO_TEST_DIR="features/support/cucumber_config_2.rb"\nexport KNAPSACK_PRO_TEST_SUITE_TOKEN_CUCUMBER=api_token_2\nexport KNAPSACK_PRO_TEST_FILE_PATTERN="features/admin_dashboard/**{,/*/**}/*.feature"\nbundle exec rake "knapsack_pro:queue:cucumber[--verbose]"\n')),(0,a.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,a.kt)("h3",{id:"how-do-i-fix-invalid-option---require"},"How do I fix ",(0,a.kt)("inlineCode",{parentName:"h3"},"invalid option: --require"),"?"),(0,a.kt)("p",null,"If you use Cucumber 2.99 and ",(0,a.kt)("inlineCode",{parentName:"p"},"cucumber-rails"),", your tests could fail with exit status 1 and the following error:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"invalid option: --require\n\nminitest options:\n    -h, --help                       Display this help.\n        --no-plugins                 Bypass minitest plugin auto-loading (or set $MT_NO_PLUGINS).\n    -s, --seed SEED                  Sets random seed. Also via env. Eg: SEED=n rake\n    -v, --verbose                    Verbose. Show progress processing files.\n    -n, --name PATTERN               Filter run on /regexp/ or string.\n        --exclude PATTERN            Exclude /regexp/ or string from run.\n\nKnown extensions: rails, pride\n    -w, --warnings                   Run with Ruby warnings enabled\n    -e, --environment ENV            Run tests in the ENV environment\n    -b, --backtrace                  Show the complete backtrace\n    -d, --defer-output               Output test failures and errors after the test run\n    -f, --fail-fast                  Abort test run on first failure or error\n    -c, --[no-]color                 Enable color in the output\n    -p, --pride                      Pride. Show your testing pride!\n")),(0,a.kt)("p",null,"The ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/cucumber/multi_test/pull/2#issuecomment-21863459"},"issue")," happens when MiniTest is required after ",(0,a.kt)("inlineCode",{parentName:"p"},"MultiTest.disable_autorun")," has been called. You can fix it with:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ruby"},"# features/support/env.rb\n\nrequire 'cucumber/rails'\n\n# After requiring cucumber/rails\nrequire 'multi_test'\nMultiTest.disable_autorun\n")),(0,a.kt)("h3",{id:"how-do-i-fix-cannot-load-such-file----stripe_mock-loaderror"},"How do I fix ",(0,a.kt)("inlineCode",{parentName:"h3"},"cannot load such file -- stripe_mock (LoadError)"),"?"),(0,a.kt)("p",null,"Knapsack Pro relies on Cucumber::Rake::Task, which uses Bundler. Bundler employs a performance trick that may ",(0,a.kt)("a",{parentName:"p",href:"https://bundler.io/man/bundle-exec.1.html#Loading"},(0,a.kt)("em",{parentName:"a"},"cause some subtle side-effects")),". You can disable such a trick with:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"export BUNDLE_DISABLE_EXEC_LOAD=true\n")),(0,a.kt)("h2",{id:"related-faqs"},"Related FAQs"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://knapsackpro.com/faq/question/how-to-require-different-cucumber-config-files-in-isolation"},"How to require different Cucumber config files in isolation?")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://knapsackpro.com/faq/question/why-green-test-suite-for-cucumber-299-tests-always-fails-with-invalid-option---require"},"Why green test suite for Cucumber 2.99 tests always fails with invalid option: --require?")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://knapsackpro.com/faq/question/how-to-solve-error-cannot-load-such-file-stripe_mock-loaderror-when-running-tests-with-cucumber"},"How to solve error cannot load such file -- ",(0,a.kt)("inlineCode",{parentName:"a"},"stripe_mock")," (LoadError) when running tests with Cucumber?"))))}p.isMDXComponent=!0}}]);